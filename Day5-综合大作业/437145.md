# ç»¼åˆå¤§ä½œä¸š

**ç¬¬ä¸€æ­¥ï¼šçˆ±å¥‡è‰ºã€Šé’æ˜¥æœ‰ä½ 2ã€‹è¯„è®ºæ•°æ®çˆ¬å–**(å‚è€ƒé“¾æ¥ï¼š[https://www.iqiyi.com/v_19ryfkiv8w.html#curid=15068699100_9f9bab7e0d1e30c494622af777f4ba39](https://www.iqiyi.com/v_19ryfkiv8w.html#curid=15068699100_9f9bab7e0d1e30c494622af777f4ba39))
* çˆ¬å–ä»»æ„ä¸€æœŸæ­£ç‰‡è§†é¢‘ä¸‹è¯„è®º
* è¯„è®ºæ¡æ•°ä¸å°‘äº1000æ¡

**ç¬¬äºŒæ­¥ï¼šè¯é¢‘ç»Ÿè®¡å¹¶å¯è§†åŒ–å±•ç¤º**
* æ•°æ®é¢„å¤„ç†ï¼šæ¸…ç†æ¸…æ´—è¯„è®ºä¸­ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ï¼š@#ï¿¥%ã€emojiè¡¨æƒ…ç¬¦ï¼‰,æ¸…æ´—åç»“æœå­˜å‚¨ä¸ºtxtæ–‡æ¡£
* ä¸­æ–‡åˆ†è¯ï¼šæ·»åŠ æ–°å¢è¯ï¼ˆå¦‚ï¼šé’ä½ ã€å¥¥åˆ©ç»™ã€å†²é¸­ï¼‰ï¼Œå»é™¤åœç”¨è¯ï¼ˆå¦‚ï¼šå“¦ã€å› æ­¤ã€ä¸ç„¶ã€ä¹Ÿå¥½ã€ä½†æ˜¯ï¼‰
* ç»Ÿè®¡top10é«˜é¢‘è¯
* å¯è§†åŒ–å±•ç¤ºé«˜é¢‘è¯

**ç¬¬ä¸‰æ­¥ï¼šç»˜åˆ¶è¯äº‘**
* æ ¹æ®è¯é¢‘ç”Ÿæˆè¯äº‘
* å¯é€‰é¡¹-æ·»åŠ èƒŒæ™¯å›¾ç‰‡ï¼Œæ ¹æ®èƒŒæ™¯å›¾ç‰‡è½®å»“ç”Ÿæˆè¯äº‘ 

**ç¬¬å››æ­¥ï¼šç»“åˆPaddleHubï¼Œå¯¹è¯„è®ºè¿›è¡Œå†…å®¹å®¡æ ¸**


# éœ€è¦çš„é…ç½®å’Œå‡†å¤‡
* ä¸­æ–‡åˆ†è¯éœ€è¦jieba
* è¯äº‘ç»˜åˆ¶éœ€è¦wordcloud
* å¯è§†åŒ–å±•ç¤ºä¸­éœ€è¦çš„ä¸­æ–‡å­—ä½“
* ç½‘ä¸Šå…¬å¼€èµ„æºä¸­æ‰¾ä¸€ä¸ªä¸­æ–‡åœç”¨è¯è¡¨
* æ ¹æ®åˆ†è¯ç»“æœè‡ªå·±åˆ¶ä½œæ–°å¢è¯è¡¨
* å‡†å¤‡ä¸€å¼ è¯äº‘èƒŒæ™¯å›¾ï¼ˆé™„åŠ é¡¹ï¼Œä¸åšè¦æ±‚ï¼Œå¯ç”¨hubæŠ å›¾å®ç°ï¼‰
* paddlehubé…ç½®




```python
!pip install jieba
!pip install wordcloud
```

    Looking in indexes: https://pypi.mirrors.ustc.edu.cn/simple/
    Requirement already satisfied: jieba in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (0.42.1)
    Looking in indexes: https://pypi.mirrors.ustc.edu.cn/simple/
    Collecting wordcloud
    [33m  WARNING: Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.VerifiedHTTPSConnection object at 0x7f3120283d10>: Failed to establish a new connection: [Errno 101] Network is unreachable')': /simple/wordcloud/[0m
    [33m  WARNING: Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.VerifiedHTTPSConnection object at 0x7f312035af90>: Failed to establish a new connection: [Errno 101] Network is unreachable')': /simple/wordcloud/[0m
    [33m  WARNING: Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.VerifiedHTTPSConnection object at 0x7f312035ae50>: Failed to establish a new connection: [Errno 101] Network is unreachable')': /simple/wordcloud/[0m
    [33m  WARNING: Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.VerifiedHTTPSConnection object at 0x7f312035aad0>: Failed to establish a new connection: [Errno 101] Network is unreachable')': /simple/wordcloud/[0m
    [33m  WARNING: Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.VerifiedHTTPSConnection object at 0x7f312035ab50>: Failed to establish a new connection: [Errno 101] Network is unreachable')': /simple/wordcloud/[0m
    [?25l  Downloading https://mirrors.tuna.tsinghua.edu.cn/pypi/web/packages/d6/af/55c7f2aa0997147943b474a74bab8deb17e7cf935b9abb8798d724c57721/wordcloud-1.6.0-cp37-cp37m-manylinux1_x86_64.whl (361kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 368kB 11.1MB/s eta 0:00:01
    [?25hRequirement already satisfied: pillow in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from wordcloud) (6.2.0)
    Requirement already satisfied: matplotlib in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from wordcloud) (2.2.3)
    Requirement already satisfied: numpy>=1.6.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from wordcloud) (1.16.4)
    Requirement already satisfied: python-dateutil>=2.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib->wordcloud) (2.8.0)
    Requirement already satisfied: pytz in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib->wordcloud) (2019.3)
    Requirement already satisfied: six>=1.10 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib->wordcloud) (1.12.0)
    Requirement already satisfied: kiwisolver>=1.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib->wordcloud) (1.1.0)
    Requirement already satisfied: cycler>=0.10 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib->wordcloud) (0.10.0)
    Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib->wordcloud) (2.4.2)
    Requirement already satisfied: setuptools in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from kiwisolver>=1.0.1->matplotlib->wordcloud) (41.4.0)
    Installing collected packages: wordcloud
    Successfully installed wordcloud-1.6.0



```python
# Linuxç³»ç»Ÿé»˜è®¤å­—ä½“æ–‡ä»¶è·¯å¾„
!ls /usr/share/fonts/
# æŸ¥çœ‹ç³»ç»Ÿå¯ç”¨çš„ttfæ ¼å¼ä¸­æ–‡å­—ä½“
!fc-list :lang=zh | grep ".ttf"
```

    cmap  truetype	type1  X11
    /home/aistudio/.fonts/simhei.ttf: SimHei,é»‘ä½“:style=Regular,Normal,obyÄejnÃ©,Standard,ÎšÎ±Î½Î¿Î½Î¹ÎºÎ¬,Normaali,NormÃ¡l,Normale,Standaard,Normalny,ĞĞ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¹,NormÃ¡lne,Navadno,Arrunta



```python
# !wget https://mydueros.cdn.bcebos.com/font/simhei.ttf # ä¸‹è½½ä¸­æ–‡å­—ä½“
# #åˆ›å»ºå­—ä½“ç›®å½•fonts
!mkdir .fonts
# # å¤åˆ¶å­—ä½“æ–‡ä»¶åˆ°è¯¥è·¯å¾„
!cp fonts/simhei.ttf .fonts/
```


```python
#å®‰è£…æ¨¡å‹
!hub install porn_detection_lstm==1.1.0
!pip install --upgrade paddlehub
```

    The version of PaddlePaddle or PaddleHub can not match module, please upgrade your PaddlePaddle or PaddleHub according to the form below.
    +--------------------------------+----------+------------------+------------------+
    |          [1;32mResourceName[0m          | [1;32mVersion[0m  |   [1;32mPaddlePaddle[0m   |    [1;32mPaddleHub[0m     |
    +--------------------------------+----------+------------------+------------------+
    |      [1;33mporn_detection_lstm[0m       |  1.1.0   |      >1.6.2      |      >1.6.0      |
    +--------------------------------+----------+------------------+------------------+
    |      [1;33mporn_detection_lstm[0m       |  1.0.0   |        -         |        -         |
    +--------------------------------+----------+------------------+------------------+
    
    Looking in indexes: https://pypi.mirrors.ustc.edu.cn/simple/
    [33mWARNING: Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ReadTimeoutError("HTTPSConnectionPool(host='mirrors.ustc.edu.cn', port=443): Read timed out. (read timeout=15)")': /pypi/web/simple/paddlehub/[0m
    [33mWARNING: Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.VerifiedHTTPSConnection object at 0x7f67499e2890>: Failed to establish a new connection: [Errno 101] Network is unreachable')': /pypi/web/simple/paddlehub/[0m
    [33mWARNING: Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.VerifiedHTTPSConnection object at 0x7f67499e2950>: Failed to establish a new connection: [Errno 101] Network is unreachable')': /pypi/web/simple/paddlehub/[0m
    [33mWARNING: Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.VerifiedHTTPSConnection object at 0x7f67499e2910>: Failed to establish a new connection: [Errno 101] Network is unreachable')': /pypi/web/simple/paddlehub/[0m
    [33mWARNING: Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.VerifiedHTTPSConnection object at 0x7f67499e2ad0>: Failed to establish a new connection: [Errno 101] Network is unreachable')': /pypi/web/simple/paddlehub/[0m
    Requirement already up-to-date: paddlehub in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (1.5.0)
    Requirement already satisfied, skipping upgrade: flask>=1.1.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (1.1.1)
    Requirement already satisfied, skipping upgrade: sentencepiece in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (0.1.85)
    Requirement already satisfied, skipping upgrade: tb-paddle in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (0.3.6)
    Requirement already satisfied, skipping upgrade: yapf==0.26.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (0.26.0)
    Requirement already satisfied, skipping upgrade: tensorboard>=1.15 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (2.1.0)
    Requirement already satisfied, skipping upgrade: gunicorn>=19.10.0; sys_platform != "win32" in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (20.0.4)
    Requirement already satisfied, skipping upgrade: cma==2.7.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (2.7.0)
    Requirement already satisfied, skipping upgrade: Pillow in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (6.2.0)
    Requirement already satisfied, skipping upgrade: six>=1.10.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (1.12.0)
    Requirement already satisfied, skipping upgrade: flake8 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (3.7.9)
    Requirement already satisfied, skipping upgrade: pandas; python_version >= "3" in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (0.23.4)
    Requirement already satisfied, skipping upgrade: colorlog in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (4.1.0)
    Requirement already satisfied, skipping upgrade: requests in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (2.22.0)
    Requirement already satisfied, skipping upgrade: pre-commit in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (1.21.0)
    Requirement already satisfied, skipping upgrade: nltk in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (3.4.5)
    Requirement already satisfied, skipping upgrade: pyyaml in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (5.1.2)
    Requirement already satisfied, skipping upgrade: numpy; python_version >= "3" in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (1.16.4)
    Requirement already satisfied, skipping upgrade: protobuf>=3.6.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (3.10.0)
    Requirement already satisfied, skipping upgrade: chardet==3.0.4 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (3.0.4)
    Requirement already satisfied, skipping upgrade: opencv-python in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub) (4.1.1.26)
    Requirement already satisfied, skipping upgrade: Werkzeug>=0.15 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask>=1.1.0->paddlehub) (0.16.0)
    Requirement already satisfied, skipping upgrade: click>=5.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask>=1.1.0->paddlehub) (7.0)
    Requirement already satisfied, skipping upgrade: itsdangerous>=0.24 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask>=1.1.0->paddlehub) (1.1.0)
    Requirement already satisfied, skipping upgrade: Jinja2>=2.10.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask>=1.1.0->paddlehub) (2.10.1)
    Requirement already satisfied, skipping upgrade: moviepy in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from tb-paddle->paddlehub) (1.0.1)
    Requirement already satisfied, skipping upgrade: markdown>=2.6.8 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from tensorboard>=1.15->paddlehub) (3.1.1)
    Requirement already satisfied, skipping upgrade: grpcio>=1.24.3 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from tensorboard>=1.15->paddlehub) (1.26.0)
    Requirement already satisfied, skipping upgrade: google-auth-oauthlib<0.5,>=0.4.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from tensorboard>=1.15->paddlehub) (0.4.1)
    Requirement already satisfied, skipping upgrade: setuptools>=41.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from tensorboard>=1.15->paddlehub) (41.4.0)
    Requirement already satisfied, skipping upgrade: wheel>=0.26; python_version >= "3" in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from tensorboard>=1.15->paddlehub) (0.33.6)
    Requirement already satisfied, skipping upgrade: absl-py>=0.4 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from tensorboard>=1.15->paddlehub) (0.8.1)
    Requirement already satisfied, skipping upgrade: google-auth<2,>=1.6.3 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from tensorboard>=1.15->paddlehub) (1.10.0)
    Requirement already satisfied, skipping upgrade: pyflakes<2.2.0,>=2.1.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flake8->paddlehub) (2.1.1)
    Requirement already satisfied, skipping upgrade: mccabe<0.7.0,>=0.6.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flake8->paddlehub) (0.6.1)
    Requirement already satisfied, skipping upgrade: entrypoints<0.4.0,>=0.3.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flake8->paddlehub) (0.3)
    Requirement already satisfied, skipping upgrade: pycodestyle<2.6.0,>=2.5.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flake8->paddlehub) (2.5.0)
    Requirement already satisfied, skipping upgrade: pytz>=2011k in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pandas; python_version >= "3"->paddlehub) (2019.3)
    Requirement already satisfied, skipping upgrade: python-dateutil>=2.5.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pandas; python_version >= "3"->paddlehub) (2.8.0)
    Requirement already satisfied, skipping upgrade: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests->paddlehub) (1.25.6)
    Requirement already satisfied, skipping upgrade: certifi>=2017.4.17 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests->paddlehub) (2019.9.11)
    Requirement already satisfied, skipping upgrade: idna<2.9,>=2.5 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests->paddlehub) (2.8)
    Requirement already satisfied, skipping upgrade: identify>=1.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->paddlehub) (1.4.10)
    Requirement already satisfied, skipping upgrade: importlib-metadata; python_version < "3.8" in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->paddlehub) (0.23)
    Requirement already satisfied, skipping upgrade: virtualenv>=15.2 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->paddlehub) (16.7.9)
    Requirement already satisfied, skipping upgrade: aspy.yaml in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->paddlehub) (1.3.0)
    Requirement already satisfied, skipping upgrade: nodeenv>=0.11.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->paddlehub) (1.3.4)
    Requirement already satisfied, skipping upgrade: cfgv>=2.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->paddlehub) (2.0.1)
    Requirement already satisfied, skipping upgrade: toml in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->paddlehub) (0.10.0)
    Requirement already satisfied, skipping upgrade: MarkupSafe>=0.23 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from Jinja2>=2.10.1->flask>=1.1.0->paddlehub) (1.1.1)
    Requirement already satisfied, skipping upgrade: proglog<=1.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from moviepy->tb-paddle->paddlehub) (0.1.9)
    Requirement already satisfied, skipping upgrade: imageio-ffmpeg>=0.2.0; python_version >= "3.4" in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from moviepy->tb-paddle->paddlehub) (0.3.0)
    Requirement already satisfied, skipping upgrade: decorator<5.0,>=4.0.2 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from moviepy->tb-paddle->paddlehub) (4.4.0)
    Requirement already satisfied, skipping upgrade: tqdm<5.0,>=4.11.2 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from moviepy->tb-paddle->paddlehub) (4.36.1)
    Requirement already satisfied, skipping upgrade: imageio<3.0,>=2.5; python_version >= "3.4" in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from moviepy->tb-paddle->paddlehub) (2.6.1)
    Requirement already satisfied, skipping upgrade: requests-oauthlib>=0.7.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard>=1.15->paddlehub) (1.3.0)
    Requirement already satisfied, skipping upgrade: pyasn1-modules>=0.2.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from google-auth<2,>=1.6.3->tensorboard>=1.15->paddlehub) (0.2.7)
    Requirement already satisfied, skipping upgrade: cachetools<5.0,>=2.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from google-auth<2,>=1.6.3->tensorboard>=1.15->paddlehub) (4.0.0)
    Requirement already satisfied, skipping upgrade: rsa<4.1,>=3.1.4 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from google-auth<2,>=1.6.3->tensorboard>=1.15->paddlehub) (4.0)
    Requirement already satisfied, skipping upgrade: zipp>=0.5 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from importlib-metadata; python_version < "3.8"->pre-commit->paddlehub) (0.6.0)
    Requirement already satisfied, skipping upgrade: oauthlib>=3.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard>=1.15->paddlehub) (3.1.0)
    Requirement already satisfied, skipping upgrade: pyasn1<0.5.0,>=0.4.6 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pyasn1-modules>=0.2.1->google-auth<2,>=1.6.3->tensorboard>=1.15->paddlehub) (0.4.8)
    Requirement already satisfied, skipping upgrade: more-itertools in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from zipp>=0.5->importlib-metadata; python_version < "3.8"->pre-commit->paddlehub) (7.2.0)



```python
from __future__ import print_function
import requests
import json
import re #æ­£åˆ™åŒ¹é…
import time #æ—¶é—´å¤„ç†æ¨¡å—
import jieba #ä¸­æ–‡åˆ†è¯
import numpy as np
import matplotlib
import matplotlib.pyplot as plt
import matplotlib.font_manager as font_manager
from PIL import Image
from wordcloud import WordCloud  #ç»˜åˆ¶è¯äº‘æ¨¡å—
import paddlehub as hub
```


    ---------------------------------------------------------------------------

    ModuleNotFoundError                       Traceback (most recent call last)

    <ipython-input-10-8390b0f83ed0> in <module>
         10 import matplotlib.font_manager as font_manager
         11 from PIL import Image
    ---> 12 from wordcloud import WordCloud  #ç»˜åˆ¶è¯äº‘æ¨¡å—
         13 import paddlehub as hub


    ModuleNotFoundError: No module named 'wordcloud'



```python
#è¯·æ±‚çˆ±å¥‡è‰ºè¯„è®ºæ¥å£ï¼Œè¿”å›responseä¿¡æ¯
def getMovieinfo(url):
    '''
    è¯·æ±‚çˆ±å¥‡è‰ºè¯„è®ºæ¥å£ï¼Œè¿”å›responseä¿¡æ¯
    å‚æ•°  url: è¯„è®ºçš„url
    :return: responseä¿¡æ¯
    '''
    session = requests.session()    #å®ä¾‹åŒ–session ä¼šè¯ä¿æŒ
    headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.122 Safari/537.36'}
    response = session.get(url,headers=headers)
    if response.status_code==200:
        return response.text


#è§£æjsonæ•°æ®ï¼Œè·å–è¯„è®º
def saveMovieInfoToFile(lastId,arr):
    '''
    è§£æjsonæ•°æ®ï¼Œè·å–è¯„è®º
    å‚æ•°  lastId:æœ€åä¸€æ¡è¯„è®ºID  arr:å­˜æ”¾æ–‡æœ¬çš„list
    :return: æ–°çš„lastId
    '''
    url ="https://sns-comment.iqiyi.com/v3/comment/get_comments.action?agent_type=118&agent_version=9.11.5&business_type=17&content_id=15068699100&page=&page_size=10&types=time&last_id="
    url += str(lastId)
    responesJson = json.loads(getMovieinfo(url))
    comments = responesJson['data']['comments']
    for val in comments:
        if 'content' in val.keys():
            # print(val['content'])
            arr.append(val['content'])
        lastId = str(val['id'])
    return lastId
```


```python
#å»é™¤æ–‡æœ¬ä¸­ç‰¹æ®Šå­—ç¬¦
def clear_special_char(content):
    '''
    æ­£åˆ™å¤„ç†ç‰¹æ®Šå­—ç¬¦
    å‚æ•° content:åŸæ–‡æœ¬
    return: æ¸…é™¤åçš„æ–‡æœ¬
    '''
    s = re.sub(r"</?(.+?)>|&nbsp;|\t|\r","",content)
    s = re.sub(r"\n","",s)
    s = re.sub(r"\*","\\*",s)
    s = re.sub("[^\u4e00-\u9fa5^a-z^A-Z^0-9]","",s)
    s = re.sub("[\001\002\003\004\005\006\007\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a]+","", s)
    s = re.sub("[a-zA-Z]","",s)
    s = re.sub("^d+(\.\d+)?$","",s)

    return s
```


```python
def fenci(text):
    '''
    åˆ©ç”¨jiebaè¿›è¡Œåˆ†è¯
    å‚æ•° text:éœ€è¦åˆ†è¯çš„å¥å­æˆ–æ–‡æœ¬
    returnï¼šåˆ†è¯ç»“æœ
    '''
    jieba.load_userdict('jieba.txt')
    seg = jieba.lcut(text, cut_all=False)
    return seg
```


```python
def stopwordslist(file_path):
    '''
    åˆ›å»ºåœç”¨è¯è¡¨
    å‚æ•° file_path:åœç”¨è¯æ–‡æœ¬è·¯å¾„
    returnï¼šåœç”¨è¯list
    '''
    stopwords = [line.strip() for line in open(file_path, encoding='UTF-8').readlines()]
    return stopwords
```


```python
def movestopwords(sentence,stopwords,counts):
    '''
    å»é™¤åœç”¨è¯,ç»Ÿè®¡è¯é¢‘
    å‚æ•° file_path:åœç”¨è¯æ–‡æœ¬è·¯å¾„ stopwords:åœç”¨è¯list counts: è¯é¢‘ç»Ÿè®¡ç»“æœ
    returnï¼šNone
    '''
    out = []
    for word in sentence:
        if word not in stopwords:
            if len(word) != 1:
                counts[word] = counts.get(word,0) + 1
    return None
    
```


```python
def drawcounts(counts,num):
    '''
    ç»˜åˆ¶è¯é¢‘ç»Ÿè®¡è¡¨
    å‚æ•° counts: è¯é¢‘ç»Ÿè®¡ç»“æœ num:ç»˜åˆ¶topN
    returnï¼šnone
    '''
    x_aixs=[]
    y_aixs=[]
    c_ordor=sorted(counts.items(),key=lambda x:x[1],reverse=True)
    for c in c_ordor[:num]:
        x_aixs.append(c[0])
        y_aixs.append(c[1])

    #è®¾ç½®æ˜¾ç¤ºä¸­æ–‡
    matplotlib.rcParams['font.sans-serif']=['simhei']
    matplotlib.rcParams['axes.unicode_minus']=False
    plt.bar(x_aixs,y_aixs)
    plt.title("è¯é¢‘ç»Ÿè®¡")
    plt.show()
    return None
```


```python
def drawcloud(word_f):
    '''
    æ ¹æ®è¯é¢‘ç»˜åˆ¶è¯äº‘å›¾
    å‚æ•° word_f:ç»Ÿè®¡å‡ºçš„è¯é¢‘ç»“æœ
    returnï¼šnone
    '''
    cloud_mask = np.array(Image.open('cloud.png'))
    #å¿½ç•¥æ˜¾ç¤ºçš„è¯
    st = set(["ä¸œè¥¿","è¿™æ˜¯"])
    wc=WordCloud(background_color='white',
    mask=cloud_mask,
    max_words=150,
    font_path='simhei.ttf',
    min_font_size=10,
    max_font_size=100,
    width=400,
    relative_scaling=0.3,
    stopwords=st)
    # wc.fit_words(word_f)
    wc.generate_from_frequencies(word_f)
    wc.to_file('pic.png')
```


```python
def text_detection(test_text,f):
    '''
    ä½¿ç”¨hubå¯¹è¯„è®ºè¿›è¡Œå†…å®¹åˆ†æ
    returnï¼šåˆ†æç»“æœ
    '''
    porn_detection_lstm = hub.Module(name="porn_detection_lstm")
    # f = open('aqy.txt','r',encoding='UTF-8')
    for line in f:
        if len(line.strip()) == 1:  #åˆ¤æ–­è¯„è®ºé•¿åº¦æ˜¯å¦ä¸º1
            continue
        else:
            test_text.append(line)
    # f.close()
    input_dict={"text":test_text}
    results=porn_detection_lstm.detection(data=input_dict,use_gpu=True,batch_size=1)
    for index, item in enumerate(results):
        if item['porn_detection_key'] == 'porn':
            print(item['text'],item['porn_probs'])
    return None
```


```python
#è¯„è®ºæ˜¯å¤šåˆ†é¡µçš„ï¼Œå¾—å¤šæ¬¡è¯·æ±‚çˆ±å¥‡è‰ºçš„è¯„è®ºæ¥å£æ‰èƒ½è·å–å¤šé¡µè¯„è®º,æœ‰äº›è¯„è®ºå«æœ‰è¡¨æƒ…ã€ç‰¹æ®Šå­—ç¬¦ä¹‹ç±»çš„
#num æ˜¯é¡µæ•°ï¼Œä¸€é¡µ10æ¡è¯„è®ºï¼Œå‡å¦‚çˆ¬å–1000æ¡è¯„è®ºï¼Œè®¾ç½®num=100
if __name__ == "__main__":
    num = 101
    lastId = '0'
    counts = {}
    arr = []
    arr_clean = []
    arr_fenci = []
    test_text = []
    stopwords = stopwordslist('stopwords.txt')
    for i in range(num):
        lastId = saveMovieInfoToFile(lastId,arr)
        # time.sleep(0.5)
    for i in arr:
        arr_clean.append(clear_special_char(i))
    print("å…±æŠ“åˆ°%dæ¡è¯„è®º"%(len(arr)))
    for i in arr_clean:
        arr_fenci.append(fenci(i))
    for i in arr_fenci:
        movestopwords(i,stopwords,counts)
    drawcounts(counts,10)
    text_detection(test_text,arr_clean)

```

    Building prefix dict from the default dictionary ...
    2020-04-28 19:53:46,378-DEBUG: Building prefix dict from the default dictionary ...
    Loading model from cache /tmp/jieba.cache
    2020-04-28 19:53:46,381-DEBUG: Loading model from cache /tmp/jieba.cache


    å…±æŠ“åˆ°1007æ¡è¯„è®º


    Loading model cost 1.016 seconds.
    2020-04-28 19:53:47,396-DEBUG: Loading model cost 1.016 seconds.
    Prefix dict has been built successfully.
    2020-04-28 19:53:47,397-DEBUG: Prefix dict has been built successfully.



![png](output_15_3.png)


    [32m[2020-04-28 19:53:48,719] [    INFO] - Installing porn_detection_lstm module[0m
    [32m[2020-04-28 19:53:48,786] [    INFO] - Module porn_detection_lstm already installed in /home/aistudio/.paddlehub/modules/porn_detection_lstm[0m


    é™†æŸ¯ç‡ƒæ—å‡¡å†²é¸­åŠ æ²¹å•Šå¤§å®¶çœ‹çœ‹è¿™ä¸¤ä¸ªå§çœŸçš„å¾ˆå¥½å•Š 0.7359
    è®©æˆ‘åº·ä¸‹æˆ‘æ˜•å§çš„ç²‰åœ¨å“ªé‡Œå–åˆ˜æ€»çœŸçš„å¤ªäº†å¥½çˆ±å¥½çˆ±è‰² 0.7552
    åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£åˆ˜é›¨æ¬£å•Šå•Šå•Šå•Šå¦ˆå¦ˆçˆ±ä½ å—·å—·å—·å—·å—·ä¹ˆä¹ˆå“’äº²äº²äº²äº²äº²äº²äº²äº²åŠ æ²¹å–” 0.8556
    å–»è¨€åˆ˜é›¨æ¬£æ›¾å¯å¦®è°¢å¯å¯…åˆ˜ä»¤å§¿è®¸ä½³çªè¿™å‡ ä¸ªæ¯”è¾ƒé€‚åˆè‰²è‰² 0.9986
    æˆ‘ä¹Ÿå–œæ¬¢è™ä¹¦æ¬£è‰²è‰²è‰² 0.9947
    è™ä¹¦æ¬£æ£’æ£’å“’ 0.6694
    è™ä¹¦æ¬£æ˜¯æœ€å¥½çš„ä¸€å¼€å§‹çš„è¯„çº§å¹¶ä¸ç®—ä»€ä¹ˆæ¬£æ¬£å·²ç»å¾ˆåŠªåŠ›äº†åŠ æ²¹çŸ³æ¦´ä»¬æŒºä½ è‰²è‰²è‰² 0.9955
    æˆ‘æ€ä¹ˆè§‰å¾—æ²¡å¿…è¦ç»§ç»­ä¸‹å»äº†ç›´æ¥å‡ºé“å§è¿™ä¹äººæ˜¯æœ€ç†æƒ³çš„äº†è‰²è‰²è‰² 0.9974
    è®¸ä½³çªå®è´æ£’æ£’çš„åŠ æ²¹æˆ‘ä¼šæ°¸è¿œæ”¯æŒä½ å“’ä¹ˆä¹ˆå“’äº²äº²äº²äº²äº²äº² 0.8274
    å¤§å®¶å¸®å¿™æŠ•ä¸€æŠ•è®¸ä½³çªå§å¥¹çœŸçš„æ˜¯ä¸€ä¸ªéå¸¸æ£’çš„å§å§è™½ç„¶å£°ä¹ä¸è¡Œä½†æ˜¯å¥¹ä¹Ÿè¯´è¿‡è‡ªå·±ä¼šåŠªåŠ›çš„å¥¹çš„èˆè¹ˆä¹Ÿæ˜¯æ£’æ£’çš„å¥¹éƒ½æ‰æ’åäº†å¸Œæœ›å¤§å®¶å¯ä»¥å¤šå¤šæ”¯æŒ 0.9853
    è‰²è‰²è‰² 0.9998
    è‰²è‰²è‰²è‰²è‰² 0.9998
    å¤å¤è‰²è‰² 0.902
    å¤å­¦é•¿å¥½å¸ˆå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šè‰² 0.5859
    è™ä¹¦æ¬£èµµå°æ£ å­”é›ªå„¿è‰²è‰² 0.971
    æ¬£æ¬£å­å†²å†²å†²è‰²è‰² 0.8359
    è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è°¢å¯å¯…è‰²è‰²è‰²è‰²è‰²è‰²è‰²è‰²è‰²è‰²è‰²è‰² 0.9795
    æˆ‘è¦å–»è¨€é«˜ä½å‡ºé“è‰²è‰²è‰²è‰² 0.9993
    èµµå°æ£ èµµå°æ£ è™ä¹¦æ¬£è™ä¹¦æ¬£è‰²è‰²è‰² 0.9788



```python
display(Image.open('WordsCloud.png')) #æ˜¾ç¤ºç”Ÿæˆçš„è¯äº‘å›¾åƒ
```


![png](output_16_0.png)

